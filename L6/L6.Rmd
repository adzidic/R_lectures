---
title: "Lecture 6: Scatter plots"
date: "`r format(Sys.time(), '%d %B %Y')`"

output:
   html_document:
     theme: flatly
     toc: true
     toc_depth: 4
     number_sections: yes
     
---

A scatterplot shows relationship between two different numeric variables in x-y coordinate plot.

Script to illustrate scatter plots in R and contains basic instructions on how to customise figures and render publishable graphs.

Data: iris (in-built dataset in R base)

# Housekeeping
```{r}
rm(list=ls()) # remove everything currently held in the R memory
```


In this example we will use the in-built dataset "iris" which gives the measurements in centimeters of the variables sepal length and width and petal length and width, respectively, for 50 flowers from each of 3 species of iris. The species are Iris setosa, versicolor, and virginica.

See ?iris for more information.

# Help on file

```{r}
head(iris)
# help(iris) or ?iris will give you mor information about the data set
?plot # info about plot function
```


# Plot and explore your data

We will focus on the Petal Length and Width data for a start and will focus on a basic plot.

## First a basic plot

You have to be very carefull to put right variable on the x-axis and on the y-axis. In plot function first variable after brackets is x and the second one is the y- variable. Later on in linear models situation is different!


```{r}
plot( iris$Petal.Width, iris$Petal.Length )
```

For each flower there is one dot as one observation of Petal.Width associated with one observation of Petal.Length. 

You can see some kind of alometric scaling, as Petal.Width increases, Petal.Length increases as well.


## Plot for publication

Now tidy up the labels and make the fonts bigger and add a line of best fit through the points see podcast on linear regression for more details.

```{r}
plot( iris$Petal.Width, iris$Petal.Length,
        xlab="Petal Width (cm)", ylab="Petal Length (cm)", pch=20 ,
        cex.lab=1.5, cex.axis=1.5, cex=1.2,
        bty="L", las=1, tcl=0.5 ) # xlab - specifies the name of the x axis label and ylab specifies the name of the y axis label; pch specifies type of point we use - pch=20 is small round dot; cex - character expansion (labels, axis and points), bty - box type. las numeric in {0,1,2,3}; the style of axis labels. 0: always parallel to the axis [default], 1: always horizontal, 2: always perpendicular to the axis, 3: always vertical. tlc - The length of tick marks as a fraction of the height of a line of text. The default value is -0.5; setting tcl = NA sets tck = -0.01 which is S' default.
abline(lm(Petal.Length~Petal.Width, data=iris),col="black", lwd=2, lty=1)
```


# Help on graph settings

```{r}

?par
?points
```

# Graph with different species in colour

This graph include information on the different species and now tidy up the labels and make the fonts bigger. We could draw a line for mean in each species. The grouping variable (Species) must be categorical (factor or character vector).

```{r}
my.colors <- c("black","blue","green")
my.points <- c(16,17,18)
levels(iris$Species) # display levels of variable Species within iris data set
plot( iris$Petal.Width, iris$Petal.Length,
        col=my.colors[iris$Species], pch=my.points[iris$Species], 
        xlab="Petal Width (cm)", ylab="Petal Length (cm)",
        cex.lab=1.5, cex.axis=1.5, cex=1.2,
        bty="L", las=1, tcl=0.5 )
legend("topleft", levels(iris$Species), col=my.colors, pch=my.points, lty=0, bty="n",
        cex=1.5) # bty = "n" means no box around legend
abline(h=mean(iris$Petal.Length[iris$Species=="virginica"]),col="green",lty=2)
abline(h=mean(iris$Petal.Length[iris$Species=="versicolor"]),col="blue",lty=2)
abline(h=mean(iris$Petal.Length[iris$Species=="setosa"]),col="black",lty=2)
palette()
colors()
text(1.5,2,labels="this graph pwns",col="peachpuff4",cex=2 ) # some other embellishments you might want to add...
# add some specific lines or points
points(2.5,2,pch=10,col="red",cex=2) 
lines(c(2.2,2.5),c(2,3),col="magenta",lwd=2)
```








# Save your data (only if you want)

The "list=" command tells us which variables we want to save. 
The "file=" option tells us what file to save the data to.

```{r}
save( list=ls(), file="grazing_data.rdata")
```


Once you are happy with your graph, you can export it as a high resolution tiff for example.

Check you working directory before saving your plot, while plot will be saved on that location.

```{r Save plot as a tiff}
tiff(filename="petal_plot_1.tif",units="cm",
		height=21,width=21, res=300, compression="none")
my.colors <- c("black","blue","green")
my.points <- c(16,17,18)
plot( iris$Petal.Width, iris$Petal.Length,
        col=my.colors[iris$Species], pch=my.points[iris$Species], 
        xlab="Petal Width (cm)", ylab="Petal Length (cm)",
        cex.lab=1.5, cex.axis=1.5, cex=1.2,
        bty="L", las=1, tcl=0.5 )
legend("topleft", levels(iris$Species), col=my.colors, pch=my.points, lty=0, bty="n",
        cex=1.5) # bty = "n" means no box around legend
```

# ggplot 

If you want the best and most sofisticated scatter plot with lots of options you should use ggplot. It is more complex than ordinary plot and requires instalation of the tidyverse package

Core elements:

    Data
    Aesthetics - aes()
    Geoms - geom_()
    Themes - theme()
    Guides - guide()

Data

The information you want to communicate. This information is generally stored in a data frame, matrix or table.

Aesthetics

The aesthetic attributes you use to represent your data. These translate the information stored in columns in your data frame into visual properties of the plot such as point location, bar height, colour, size, shape etc..

Geoms

These are the geometric objects on the plot, e.g. lines, bars and points.

Themes

These adjust the overall appearance of the plot, e.g. background colour.

Guides

These objects help the viewer to interpret the plot, e.g. axis labels and legends.


```{r ggplot package scatter plot}

library(tidyverse) # load package with ggplot
tiff(filename="petal_plot_2.tif",units="cm", height=21,width=21, res=300, compression="none") # save file as a tiff


ggplot(data= iris, mapping = aes(x=Petal.Width,y=Petal.Length)) + geom_point(mapping = aes(color = Species, shape=Species)) + 
  geom_smooth() + ggtitle("Petal width and length plot") + 
                theme(plot.title = element_text(hjust = 0.5), axis.text=element_text(size=12),
        axis.title=element_text(size=14,face="bold")) + 
  labs( x="Petal width (cm)",y="Petal Length(cm)") 

# aesthetics defines x and y axis; geom_point defines classification variable Species for shape and colour; geom_smooth provides shoothing curve through data; ggtitle defines title; theme adjust title in the centre of the plot; axis.text - defines text size for axis text; axis.title - defines size and style of the axis text; labs defines x and y - axis labels.



```


```{r ggplot package scatter plot with manual shape scale}

library(tidyverse)

tiff(filename="petal_plot_3.tif",units="cm", height=21,width=21, res=300, compression="none")

ggplot(data= iris, mapping = aes(x=Petal.Width,y=Petal.Length)) + geom_point(mapping = aes(color = Species, shape=Species)) + 
  geom_smooth() + ggtitle("Petal width and length plot") + scale_shape_manual (values=4:6) +
                theme(plot.title = element_text(hjust = 0.5), axis.text=element_text(size=12),
        axis.title=element_text(size=14,face="bold")) + 
  labs( x="Petal width (cm)",y="Petal Length(cm)")
# the only difference with previous graph is that each shape variable (Species) is defined manualy with scale_shape_manual.
```






